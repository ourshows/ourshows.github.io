<!doctype html>
<html lang="en">
<head>
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¬</text></svg>">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OurShow â€” Modern</title>

  <!-- Apple & PWA -->
  <meta name="theme-color" content="#000000" />
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="/icons/icon-192x192.png">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Minimal page CSS (glass styles + small layout helpers) -->
  <style>
    :root {
      --glass-bg: rgba(255,255,255,0.04);
      --glass-border: rgba(255,255,255,0.06);
      --accent-from: #ef4444;
      --accent-to: #ec4899;
    }

    /* Glassy panels used across the UI */
    .glass-panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      backdrop-filter: blur(8px) saturate(120%);
      border: 1px solid var(--glass-border);
      box-shadow: 0 8px 30px rgba(2,6,23,0.6);
      color: white;
    }

    /* navigation chips */
    .glass-nav {
      padding: .5rem .75rem;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.03);
      background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      transition: transform .15s ease, background .2s;
      font-weight: 600;
      display:inline-flex;
      align-items:center;
      gap:.5rem;
    }
    .glass-nav:hover { transform: translateY(-3px) scale(1.02); }

    /* small icon buttons in header */
    .glass-icon {
      display:inline-flex;align-items:center;justify-content:center;
      width:44px;height:44px;border-radius:10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      box-shadow: 0 6px 18px rgba(2,6,23,0.6);
      transition: transform .12s ease, background .12s;
      cursor:pointer;
    }
    .glass-icon:hover { transform: translateY(-3px); background: rgba(255,255,255,0.03); }

    /* input style */
    .glass-input {
      width:100%;
      padding:.6rem .9rem;
      border-radius:12px;
      background: rgba(255,255,255,0.03);
      border:1px solid rgba(255,255,255,0.04);
      outline:none;color:inherit;
      box-shadow: inset 0 -2px 6px rgba(0,0,0,0.35);
    }
    .glass-input:focus { box-shadow: 0 6px 20px rgba(0,0,0,0.6), inset 0 -2px 6px rgba(0,0,0,0.45); }

    /* suggestion item */
    #search-suggestions .suggest-item { padding:.5rem; display:flex; gap:.6rem; align-items:center; cursor:pointer; }
    #search-suggestions .suggest-item:hover { background: rgba(255,255,255,0.02); }

    /* mobile navigation rows */
    .mobile-nav {
      display:block;padding:.9rem 1rem;border-radius:12px;
      background: rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.02);
    }

    /* dropdown items & profile */
    .dropdown-item {
      display:block;padding:.8rem 1rem;border-bottom:1px solid rgba(255,255,255,0.02);
      background:transparent;color:inherit;text-decoration:none;
    }
    .dropdown-item:hover { background: rgba(255,255,255,0.02); }

    /* modal specifics */
    .modal-container { max-width:1100px; }
    .modal-poster { width:160px; border-radius:12px; box-shadow: 0 10px 30px rgba(0,0,0,0.6); }

    /* cards (large poster style) */
    .movie-card { border-radius:12px; overflow:hidden; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); transition: transform .22s ease, box-shadow .22s; }
    .movie-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 20px 60px rgba(2,6,23,0.65); z-index:20; }

    /* responsive tweaks */
    @media (max-width: 768px) {
      header { top: 12px; }
      .modal-poster { width:110px; }
      .glass-icon { width:40px;height:40px; }
    }

    /* small utilities */
    .hidden { display:none; }
    .muted { color: #9ca3af; }

    /* subtle accent button */
    .accent-btn {
      background: linear-gradient(90deg, var(--accent-from), var(--accent-to));
      padding:.6rem .9rem;border-radius:10px;color:white;font-weight:600;border:none;
      box-shadow: 0 8px 24px rgba(236,72,153,0.12);
    }
  </style>

  <!-- Core Scripts (firebase-config provides waitForFirebase + window.dbMod/window.authMod fallback) -->
  <script src="firebase-config.js"></script>
  <script src="config.js"></script>
</head>
<body class="bg-gray-900 text-white font-sans selection:bg-red-500/40">

  <!-- Glassmorphism Header A -->
  <header class="fixed top-4 left-1/2 -translate-x-1/2 w-[95%] md:w-[90%] lg:w-[80%] z-50">
    <div class="backdrop-blur-xl glass-panel rounded-2xl px-4 py-3 flex items-center justify-between">

      <!-- Logo -->
      <a href="index.html" class="flex items-center gap-3 hover:scale-105 transition-all">
        <div class="px-3 py-2 rounded-xl bg-gradient-to-br from-red-600 to-red-700 shadow-lg">
          <span class="text-white font-extrabold text-lg">OUR</span>
        </div>
        <span class="text-2xl font-extrabold bg-gradient-to-r from-red-500 to-pink-500 bg-clip-text text-transparent">Show</span>
      </a>

      <!-- Center Nav Chips -->
      <nav class="hidden md:flex gap-3">
        <a href="ai.html" class="glass-nav">ğŸ¤– AI</a>
        <a href="post.html" class="glass-nav">ğŸ“ Posts</a>
        <a href="community.html" class="glass-nav">ğŸ’¬ Chat</a>
        <a href="watch&download.html" class="glass-nav">ğŸ“¥ Download</a>
      </nav>

      <!-- Right Side Tools -->
      <div class="hidden md:flex items-center gap-3">

        <!-- Surprise Me -->
        <button id="surprise-btn" class="glass-icon" title="Surprise me">ğŸ²</button>

        <!-- Download App -->
        <a id="install-app" class="glass-icon" href="watch&download.html" title="Download App">â¬‡ï¸</a>

        <!-- Notifications -->
        <button id="notify-btn" class="relative glass-icon" title="Notifications">
          ğŸ””
          <span id="notify-count" class="absolute -top-1 -right-1 bg-red-500 text-xs px-1.5 py-0.5 rounded-full hidden">0</span>
        </button>

        <!-- Theme Toggle -->
        <button id="theme-toggle" class="glass-icon" title="Theme">ğŸŒ“</button>

        <!-- Profile -->
        <div class="relative">
          <button id="profile-btn" class="flex items-center gap-2 glass-nav px-3 py-2" aria-haspopup="true" aria-expanded="false">
            <img id="profile-pic" class="w-8 h-8 rounded-full border-2 border-white/20" src="https://via.placeholder.com/36" alt="profile" />
            <span id="profile-name" class="text-sm">Guest</span>
          </button>
          <div id="profile-dropdown" class="hidden absolute right-0 mt-2 glass-panel w-48 rounded-xl overflow-hidden">
            <a href="profile.html" class="dropdown-item" id="edit-profile-link">ğŸ‘¤ Edit Profile</a>
            <a href="watchlist.html" class="dropdown-item">â­ Watchlist</a>
            <a href="watchlater.html" class="dropdown-item">â³ Watch Later</a>
            <button id="logout-btn" class="dropdown-item text-red-400">ğŸšª Logout</button>
          </div>
        </div>
      </div>

      <!-- Mobile Menu Button -->
      <button id="menu-btn" class="md:hidden glass-icon" aria-label="Open menu">â˜°</button>
    </div>

    <!-- Mobile Drawer -->
    <div id="mobile-menu" class="hidden fixed inset-0 bg-black/60 backdrop-blur-md z-40">
      <div class="absolute left-0 top-0 w-3/4 max-w-sm h-full p-5 space-y-4 glass-panel rounded-r-2xl">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="px-2 py-1 bg-gradient-to-br from-red-600 to-red-700 rounded-lg">
              <span class="font-bold">OUR</span>
            </div>
            <div class="font-bold">Show</div>
          </div>
          <button id="close-mobile" class="text-red-400 text-xl">âœ–</button>
        </div>

        <nav class="flex flex-col gap-3">
          <a href="ai.html" class="mobile-nav">ğŸ¤– AI</a>
          <a href="post.html" class="mobile-nav">ğŸ“ Posts</a>
          <a href="community.html" class="mobile-nav">ğŸ’¬ Chat</a>
          <a href="watch&download.html" class="mobile-nav">ğŸ“¥ Download</a>
          <a href="watchlist.html" class="mobile-nav">â­ Watchlist</a>
          <a href="watchlater.html" class="mobile-nav">â³ Watch Later</a>
          <button id="mobile-theme" class="mobile-nav">ğŸŒ“ Theme</button>
          <button id="mobile-surprise" class="mobile-nav">ğŸ² Surprise Me</button>
        </nav>
      </div>
    </div>
  </header>

  <!-- Search + Sort -->
  <section class="max-w-6xl mx-auto pt-28 p-4 space-y-4">
    <div class="flex items-center gap-3">
      <div class="relative flex-1">
        <input id="search-input" placeholder="Search movies, series, genres..." class="glass-input" aria-label="Search" />
        <div id="search-suggestions" class="absolute left-0 top-full w-full glass-panel rounded-xl mt-2 hidden max-h-80 overflow-y-auto"></div>
      </div>

      <select id="sort-select" class="glass-input w-40" aria-label="Sort by">
        <option value="popularity.desc">Trending</option>
        <option value="popularity.desc">Most Popular</option>
        <option value="vote_average.desc">Highest Rated</option>
        <option value="primary_release_date.desc">Latest Release</option>
        <option value="original_title.asc">Aâ€“Z</option>
      </select>
    </div>

    <!-- Filters Panel (expanded by JS if needed) -->
    <div id="filters" class="glass-panel p-4 rounded-xl space-y-2 text-sm">
      <h3 class="text-lg font-semibold mb-2">ğŸ¯ Advanced Filters</h3>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
        <select id="filter-genre" class="glass-input" aria-label="Genre">
          <option value="">Any genre</option>
          <option value="28">Action</option>
          <option value="35">Comedy</option>
          <option value="27">Horror</option>
          <option value="10749">Romance</option>
          <option value="878">Sci-Fi</option>
        </select>

        <select id="filter-year" class="glass-input" aria-label="Year">
          <option value="">Any year</option>
          <option value="2024">2024</option>
          <option value="2023">2023</option>
          <option value="2020-2022">2020s</option>
          <option value="2010-2019">2010s</option>
        </select>

        <select id="filter-rating" class="glass-input" aria-label="Rating">
          <option value="">Any rating</option>
          <option value="7">> 7.0</option>
          <option value="8">> 8.0</option>
          <option value="9">> 9.0</option>
        </select>

        <select id="filter-lang" class="glass-input" aria-label="Language">
          <option value="">Any language</option>
          <option value="en">English</option>
          <option value="hi">Hindi</option>
          <option value="ko">Korean</option>
        </select>
      </div>
    </div>
  </section>

  <!-- Pages -->
  <main class="max-w-6xl mx-auto p-4 space-y-10">
    <section id="page-home" class="spa-page space-y-10">
      <div id="sections-container" class="space-y-10"></div>
    </section>

    <section id="page-all" class="spa-page hidden">
      <div class="flex justify-between items-center mb-3">
        <h2 id="all-title" class="text-xl font-semibold"></h2>
        <button id="back-home" class="text-red-500">â€¹ Back</button>
      </div>
      <div id="all-content" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4"></div>
    </section>

    <section id="page-search" class="spa-page hidden">
      <h2 class="text-xl font-semibold mb-3">ğŸ” Search Results</h2>
      <div id="search-content" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4"></div>
    </section>
  </main>

  <!-- Modal -->
  <div id="detail-modal" class="hidden fixed inset-0 flex items-center justify-center bg-black/70 backdrop-blur-md z-50" role="dialog" aria-modal="true">
    <div class="modal-container glass-panel rounded-2xl shadow-2xl w-11/12 md:w-3/4 lg:w-2/3 max-h-[90vh] overflow-y-auto relative">
      <button id="close-modal" class="absolute top-4 right-6 text-2xl">âœ–</button>
      <div id="modal-content" class="p-6"></div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="max-w-6xl mx-auto p-6 text-center text-sm text-gray-400">
    Â© <span id="year"></span> OurShow â€” Built with â¤ï¸
  </footer>

  <!-- Main app logic -->
  <script type="module" src="main.js" defer></script>

  <!-- Small UI wiring (keeps header interactive even before full main.js loads) -->
  <script>
    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Mobile menu toggles
    document.getElementById('menu-btn')?.addEventListener('click', () => {
      document.getElementById('mobile-menu').classList.toggle('hidden');
    });
    document.getElementById('close-mobile')?.addEventListener('click', () => {
      document.getElementById('mobile-menu').classList.add('hidden');
    });

    // Profile dropdown
    const profileBtn = document.getElementById('profile-btn');
    const profileDropdown = document.getElementById('profile-dropdown');
    profileBtn?.addEventListener('click', (e) => {
      const expanded = profileBtn.getAttribute('aria-expanded') === 'true';
      profileBtn.setAttribute('aria-expanded', (!expanded).toString());
      profileDropdown.classList.toggle('hidden');
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', (e) => {
      if (!profileBtn?.contains(e.target) && !profileDropdown?.contains(e.target)) {
        profileDropdown?.classList.add('hidden');
        profileBtn?.setAttribute('aria-expanded', 'false');
      }
    });

    // Close modal
    document.getElementById('close-modal')?.addEventListener('click', () => {
      document.getElementById('detail-modal').classList.add('hidden');
    });

    // Small helpers for keyboard Escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        document.getElementById('detail-modal')?.classList.add('hidden');
        document.getElementById('mobile-menu')?.classList.add('hidden');
      }
    });

    // Wire Surprise mobile button
    document.getElementById('mobile-surprise')?.addEventListener('click', (e) => {
      e.preventDefault();
      // main.js defines surpriseToggleRandom()
      if (window.surpriseToggleRandom) window.surpriseToggleRandom();
    });

    // Wire theme toggle quick UI update (main.js will finalize)
    document.getElementById('theme-toggle')?.addEventListener('click', () => {
      // main.js will provide toggleThemeCycle(); call if present
      if (window.toggleThemeCycle) window.toggleThemeCycle();
    });

    // Wire surprise button desktop
    document.getElementById('surprise-btn')?.addEventListener('click', () => {
      if (window.surpriseToggleRandom) window.surpriseToggleRandom();
    });

    // Wire install/download button to PWA prompt handled in pwa-install.js or follow link
    document.getElementById('install-app')?.addEventListener('click', (e) => {
      // if pwa-install exposes promptInstall, call it; otherwise fallback to link (already href)
      if (window.promptInstall) {
        e.preventDefault();
        window.promptInstall();
      }
    });

    // sort select pass-through to main.js - main will attach advanced behavior
    document.getElementById('sort-select')?.addEventListener('change', (e) => {
      if (window.handleSortChange) window.handleSortChange(e.target.value);
    });

    // search input enter key triggers main.js search
    document.getElementById('search-input')?.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && window.performSearch) {
        window.performSearch(e.target.value);
      }
    });
  </script>

  <!-- Optional: PWA install prompt handler if you have pwa-install.js -->
  <script src="pwa-install.js"></script>
</body>
</html>
